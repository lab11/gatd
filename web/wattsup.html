<html>
<head>
	<script src="js/socket.io-0.8.7.js"></script>
	<script src="js/jquery-1.10.2.min.js"></script>
	<script src="js/jquery-ui-1.10.3.custom.min.js"></script>
	<script src="js/jsIP.js"></script>
	<script src="js/flot/jquery.flot-0.8.1.js"></script>
	<script src="js/flot/jquery.flot.time-0.8.1.js"></script>
	<script src="js/underscore.js"></script>
	<script src="js/jquery.grapher.js"></script>
	<script src="js/gatd_graph.js"></script>
	<script>WEB_SOCKET_SWF_LOCATION='misc/WebSocketMain.swf'</script>

	<link href="css/gatd_graph.css" media="all" rel="stylesheet" type="text/css" />

	<title>Watts Up? .net</title>
</head>

<body>
	<div id="headerBar">
		<div style="width:1000px; margin:0 auto; text-align:center;">
			<div style="float:left"><img src="images/BlockM-rball.png" height="50px" style="margin-top:5px;" /></div>
			<div style="float:left; padding:6px 0 0 350px;">Watts Up? .net</div>
		</div>
	</div>

	<div id="body">
		<div id="graph" class="box_shadow graph"></div>
		<div id="key" class="box_shadow key">
			<table id="key_table">
				<tr>
					<th>Index</th><th>ID</th><th>Description</th><th>Location</th>
				</tr>
			</table>
		</div>
	</div>

	<script>

	var WUP_PID = 'YWUr2G8AZP';
	var s;

	onload = function() {
		s = io.connect('inductor.eecs.umich.edu:8080/stream');
		s.on('connect', function (data) {
			s.emit('query', {'profile_id': WUP_PID,
	                         'description': {'$exists': true}}
			      );
		});

		s.on('data', function (data) {
			var uid = data['wattsupid'].toString()
			var color = get_color(uid)
			add_to_key(g,
				uid,
				data['description'],
				data['location_str'],
				color)
			add_to_graph(g, uid, data['time'], data['watts'], color);
		});


		g = $.grapher($("#graph"),
			{legend: {show: false, conainer: $("#graph_key")},
			 xaxis:  {show:true, width:300000, mode: "time", tickFormatter:x_format},
			 yaxis:  {min:0, label:"Power (watts)", max:250},
			 grid:   {margin: {top: 8, bottom: 20, left: 25, right: 25}},
			});

		$("th").click(function() {
			series = 'all';
		});
	}
	</script>


</body>
</html>